(self["webpackChunkModoboa"]=self["webpackChunkModoboa"]||[]).push([[785],{7785:function(t,r,e){"use strict";e.r(r),e.d(r,{default:function(){return m}});var s=e(4562),o=e(266),n=e(5495),a=e(1713),i=e(7808),l=function(){var t=this,r=t._self._c;return r(a.Z,{staticStyle:{height:"100%",margin:"0 auto"}},[r(o.Z,{staticClass:"primary",staticStyle:{height:"100%"},attrs:{cols:"0",sm:"6"}},[r(n.Z,{staticClass:"mt-10 ml-8",attrs:{src:e(5238),"max-width":"300"}})],1),r(o.Z,{staticClass:"d-flex flex-column justify-center pa-10",attrs:{cols:"12",sm:"6"},on:{keyup:function(r){return!r.type.indexOf("key")&&t._k(r.keyCode,"enter",13,r.key,"Enter")?null:t.changePassword.apply(null,arguments)}}},[r("span",{staticClass:"primary--text mb-6 text-h4"},[r("translate",[t._v("Forgot password?")])],1),r("validation-observer",{ref:"observer"},[r("validation-provider",{attrs:{vid:"password",rules:"required"},scopedSlots:t._u([{key:"default",fn:function({errors:e}){return[r("p",{attrs:{id:"password_validation"}},[t._v(t._s(t.password_validation_error))]),r("label",{staticClass:"m-label"},[r("translate",[t._v("Change password")])],1),r(i.Z,{attrs:{"error-messages":e,type:"password",outlined:""},model:{value:t.password,callback:function(r){t.password=r},expression:"password"}})]}}])}),r("validation-provider",{attrs:{vid:"password_confirm",rules:"required|samePassword:password"},scopedSlots:t._u([{key:"default",fn:function({errors:e}){return[r(i.Z,{attrs:{"error-messages":e,type:"password",outlined:""},model:{value:t.password_confirmed,callback:function(r){t.password_confirmed=r},expression:"password_confirmed"}})]}}])})],1),r("div",{staticClass:"d-flex justify-center"},[r(s.Z,{staticClass:"flex-grow-1",attrs:{color:"primary",large:"",loading:t.loading},on:{click:t.changePassword}},[r("translate",[t._v("Submit")])],1)],1),r("div",[r("router-link",{staticClass:"float-right primary--text",attrs:{to:{name:"Login"}}},[r("translate",[t._v("Return to login")])],1)],1)],1)],1)},c=[],d=(e(7658),e(2801),e(9895)),u={data(){return{loading:!1,password:"",password_confirmed:"",password_validation_error:"",errors:{},token:"",id:""}},methods:{checkUrl:function(){if(void 0===this.$route.params.token)""!==this.token&&""!==this.id||this.$router.push({name:"PasswordRecoveryForm"});else{const t=atob(this.$route.params.id);/^\d+$/.test(t)?(this.id=this.$route.params.id,this.token=this.$route.params.token,this.$router.push({name:"PasswordRecoveryChangeForm"})):this.$router.push({name:"PasswordRecoveryForm"})}},async changePassword(){const t=await this.$refs.observer.validate();if(!t)return;const r={new_password1:this.password,new_password2:this.password_confirmed,token:this.token,id:this.id};this.loading=!0,this.password_validation_error="",d.Z.changePassword(r).then((t=>{200===t.status&&(this.loading=!1,this.returnLogin())})).catch((t=>{let r="";this.loading=!1,403===t.response.status?r=this.$gettext("Invalid reset token."):404===t.response.status?r=this.$gettext("User unknown."):400===t.response.status&&"password_requirement"===t.response.data.type?t.response.data.errors.forEach((t=>{r+=this.$gettext(t)+"<br>"})):429===t.response.status&&(r=this.$gettext("Too many unsuccessful attempts, please try later.")),this.password_validation_error=r}))}},beforeMount(){this.checkUrl()}},p=u,f=e(1001),E=(0,f.Z)(p,l,c,!1,null,null,null),m=E.exports},5787:function(t,r,e){var s=e(7976),o=TypeError;t.exports=function(t,r){if(s(r,t))return t;throw o("Incorrect invocation")}},3678:function(t){t.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},2801:function(t,r,e){"use strict";var s=e(2109),o=e(7854),n=e(5005),a=e(9114),i=e(3070).f,l=e(2597),c=e(5787),d=e(9587),u=e(6277),p=e(3678),f=e(1060),E=e(9781),m=e(1913),g="DOMException",_=n("Error"),h=n(g),R=function(){c(this,y);var t=arguments.length,r=u(t<1?void 0:arguments[0]),e=u(t<2?void 0:arguments[1],"Error"),s=new h(r,e),o=_(r);return o.name=g,i(s,"stack",a(1,f(o.stack,1))),d(s,this,R),s},y=R.prototype=h.prototype,w="stack"in _(g),v="stack"in new h(1,2),S=h&&E&&Object.getOwnPropertyDescriptor(o,g),C=!!S&&!(S.writable&&S.configurable),k=w&&!C&&!v;s({global:!0,constructor:!0,forced:m||k},{DOMException:k?R:h});var b=n(g),I=b.prototype;if(I.constructor!==b)for(var N in m||i(I,"constructor",a(1,b)),p)if(l(p,N)){var T=p[N],O=T.s;l(b,O)||i(b,O,a(6,T.c))}},266:function(t,r,e){"use strict";e(7658),e(1884);var s=e(144),o=e(1767),n=e(5352);const a=["sm","md","lg","xl"],i=(()=>a.reduce(((t,r)=>(t[r]={type:[Boolean,String,Number],default:!1},t)),{}))(),l=(()=>a.reduce(((t,r)=>(t["offset"+(0,n.jC)(r)]={type:[String,Number],default:null},t)),{}))(),c=(()=>a.reduce(((t,r)=>(t["order"+(0,n.jC)(r)]={type:[String,Number],default:null},t)),{}))(),d={col:Object.keys(i),offset:Object.keys(l),order:Object.keys(c)};function u(t,r,e){let s=t;if(null!=e&&!1!==e){if(r){const e=r.replace(t,"");s+=`-${e}`}return"col"!==t||""!==e&&!0!==e?(s+=`-${e}`,s.toLowerCase()):s.toLowerCase()}}const p=new Map;r["Z"]=s.ZP.extend({name:"v-col",functional:!0,props:{cols:{type:[Boolean,String,Number],default:!1},...i,offset:{type:[String,Number],default:null},...l,order:{type:[String,Number],default:null},...c,alignSelf:{type:String,default:null,validator:t=>["auto","start","end","center","baseline","stretch"].includes(t)},tag:{type:String,default:"div"}},render(t,{props:r,data:e,children:s,parent:n}){let a="";for(const o in r)a+=String(r[o]);let i=p.get(a);if(!i){let t;for(t in i=[],d)d[t].forEach((e=>{const s=r[e],o=u(t,e,s);o&&i.push(o)}));const e=i.some((t=>t.startsWith("col-")));i.push({col:!e||!r.cols,[`col-${r.cols}`]:r.cols,[`offset-${r.offset}`]:r.offset,[`order-${r.order}`]:r.order,[`align-self-${r.alignSelf}`]:r.alignSelf}),p.set(a,i)}return t(r.tag,(0,o.ZP)(e,{class:i}),s)}})},1713:function(t,r,e){"use strict";e(7658),e(1884);var s=e(144),o=e(1767),n=e(5352);const a=["sm","md","lg","xl"],i=["start","end","center"];function l(t,r){return a.reduce(((e,s)=>(e[t+(0,n.jC)(s)]=r(),e)),{})}const c=t=>[...i,"baseline","stretch"].includes(t),d=l("align",(()=>({type:String,default:null,validator:c}))),u=t=>[...i,"space-between","space-around"].includes(t),p=l("justify",(()=>({type:String,default:null,validator:u}))),f=t=>[...i,"space-between","space-around","stretch"].includes(t),E=l("alignContent",(()=>({type:String,default:null,validator:f}))),m={align:Object.keys(d),justify:Object.keys(p),alignContent:Object.keys(E)},g={align:"align",justify:"justify",alignContent:"align-content"};function _(t,r,e){let s=g[t];if(null!=e){if(r){const e=r.replace(t,"");s+=`-${e}`}return s+=`-${e}`,s.toLowerCase()}}const h=new Map;r["Z"]=s.ZP.extend({name:"v-row",functional:!0,props:{tag:{type:String,default:"div"},dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:c},...d,justify:{type:String,default:null,validator:u},...p,alignContent:{type:String,default:null,validator:f},...E},render(t,{props:r,data:e,children:s}){let n="";for(const o in r)n+=String(r[o]);let a=h.get(n);if(!a){let t;for(t in a=[],m)m[t].forEach((e=>{const s=r[e],o=_(t,e,s);o&&a.push(o)}));a.push({"no-gutters":r.noGutters,"row--dense":r.dense,[`align-${r.align}`]:r.align,[`justify-${r.justify}`]:r.justify,[`align-content-${r.alignContent}`]:r.alignContent}),h.set(n,a)}return t(r.tag,(0,o.ZP)(e,{staticClass:"row",class:a}),s)}})},9895:function(t,r,e){"use strict";var s=e(2201);r["Z"]={requestToken(t){return s.Z.post("/token/",t)},recoverPassword(t){return s.Z.post("/password_reset/",t)},checkSmsTotp(t){return s.Z.post("/sms_totp/",t)},changePassword(t){return s.Z.post("/reset_confirm/",t)}}}}]);
//# sourceMappingURL=785.b6d1416c.js.map