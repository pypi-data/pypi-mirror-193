{"version":3,"file":"chunks/10151.11d3f405eacf762e4361.min.js","mappings":"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","sources":["webpack://plone-mosaic/./node_modules/tinymce/plugins/toc/plugin.js"],"sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.10.7 (2022-12-06)\n */\n(function () {\n    'use strict';\n\n    var global$3 = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n    var global$2 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n\n    var global$1 = tinymce.util.Tools.resolve('tinymce.util.I18n');\n\n    var global = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n    var getTocClass = function (editor) {\n      return editor.getParam('toc_class', 'mce-toc');\n    };\n    var getTocHeader = function (editor) {\n      var tagName = editor.getParam('toc_header', 'h2');\n      return /^h[1-6]$/.test(tagName) ? tagName : 'h2';\n    };\n    var getTocDepth = function (editor) {\n      var depth = parseInt(editor.getParam('toc_depth', '3'), 10);\n      return depth >= 1 && depth <= 9 ? depth : 3;\n    };\n\n    var create = function (prefix) {\n      var counter = 0;\n      return function () {\n        var guid = new Date().getTime().toString(32);\n        return prefix + guid + (counter++).toString(32);\n      };\n    };\n\n    var tocId = create('mcetoc_');\n    var generateSelector = function (depth) {\n      var i;\n      var selector = [];\n      for (i = 1; i <= depth; i++) {\n        selector.push('h' + i);\n      }\n      return selector.join(',');\n    };\n    var hasHeaders = function (editor) {\n      return readHeaders(editor).length > 0;\n    };\n    var readHeaders = function (editor) {\n      var tocClass = getTocClass(editor);\n      var headerTag = getTocHeader(editor);\n      var selector = generateSelector(getTocDepth(editor));\n      var headers = editor.$(selector);\n      if (headers.length && /^h[1-9]$/i.test(headerTag)) {\n        headers = headers.filter(function (i, el) {\n          return !editor.dom.hasClass(el.parentNode, tocClass);\n        });\n      }\n      return global.map(headers, function (h) {\n        var id = h.id;\n        return {\n          id: id ? id : tocId(),\n          level: parseInt(h.nodeName.replace(/^H/i, ''), 10),\n          title: editor.$.text(h),\n          element: h\n        };\n      });\n    };\n    var getMinLevel = function (headers) {\n      var minLevel = 9;\n      for (var i = 0; i < headers.length; i++) {\n        if (headers[i].level < minLevel) {\n          minLevel = headers[i].level;\n        }\n        if (minLevel === 1) {\n          return minLevel;\n        }\n      }\n      return minLevel;\n    };\n    var generateTitle = function (tag, title) {\n      var openTag = '<' + tag + ' contenteditable=\"true\">';\n      var closeTag = '</' + tag + '>';\n      return openTag + global$2.DOM.encode(title) + closeTag;\n    };\n    var generateTocHtml = function (editor) {\n      var html = generateTocContentHtml(editor);\n      return '<div class=\"' + editor.dom.encode(getTocClass(editor)) + '\" contenteditable=\"false\">' + html + '</div>';\n    };\n    var generateTocContentHtml = function (editor) {\n      var html = '';\n      var headers = readHeaders(editor);\n      var prevLevel = getMinLevel(headers) - 1;\n      if (!headers.length) {\n        return '';\n      }\n      html += generateTitle(getTocHeader(editor), global$1.translate('Table of Contents'));\n      for (var i = 0; i < headers.length; i++) {\n        var h = headers[i];\n        h.element.id = h.id;\n        var nextLevel = headers[i + 1] && headers[i + 1].level;\n        if (prevLevel === h.level) {\n          html += '<li>';\n        } else {\n          for (var ii = prevLevel; ii < h.level; ii++) {\n            html += '<ul><li>';\n          }\n        }\n        html += '<a href=\"#' + h.id + '\">' + h.title + '</a>';\n        if (nextLevel === h.level || !nextLevel) {\n          html += '</li>';\n          if (!nextLevel) {\n            html += '</ul>';\n          }\n        } else {\n          for (var ii = h.level; ii > nextLevel; ii--) {\n            if (ii === nextLevel + 1) {\n              html += '</li></ul><li>';\n            } else {\n              html += '</li></ul>';\n            }\n          }\n        }\n        prevLevel = h.level;\n      }\n      return html;\n    };\n    var isEmptyOrOffscreen = function (editor, nodes) {\n      return !nodes.length || editor.dom.getParents(nodes[0], '.mce-offscreen-selection').length > 0;\n    };\n    var insertToc = function (editor) {\n      var tocClass = getTocClass(editor);\n      var $tocElm = editor.$('.' + tocClass);\n      if (isEmptyOrOffscreen(editor, $tocElm)) {\n        editor.insertContent(generateTocHtml(editor));\n      } else {\n        updateToc(editor);\n      }\n    };\n    var updateToc = function (editor) {\n      var tocClass = getTocClass(editor);\n      var $tocElm = editor.$('.' + tocClass);\n      if ($tocElm.length) {\n        editor.undoManager.transact(function () {\n          $tocElm.html(generateTocContentHtml(editor));\n        });\n      }\n    };\n\n    var register$1 = function (editor) {\n      editor.addCommand('mceInsertToc', function () {\n        insertToc(editor);\n      });\n      editor.addCommand('mceUpdateToc', function () {\n        updateToc(editor);\n      });\n    };\n\n    var setup = function (editor) {\n      var $ = editor.$, tocClass = getTocClass(editor);\n      editor.on('PreProcess', function (e) {\n        var $tocElm = $('.' + tocClass, e.node);\n        if ($tocElm.length) {\n          $tocElm.removeAttr('contentEditable');\n          $tocElm.find('[contenteditable]').removeAttr('contentEditable');\n        }\n      });\n      editor.on('SetContent', function () {\n        var $tocElm = $('.' + tocClass);\n        if ($tocElm.length) {\n          $tocElm.attr('contentEditable', false);\n          $tocElm.children(':first-child').attr('contentEditable', true);\n        }\n      });\n    };\n\n    var toggleState = function (editor) {\n      return function (api) {\n        var toggleDisabledState = function () {\n          return api.setDisabled(editor.mode.isReadOnly() || !hasHeaders(editor));\n        };\n        toggleDisabledState();\n        editor.on('LoadContent SetContent change', toggleDisabledState);\n        return function () {\n          return editor.on('LoadContent SetContent change', toggleDisabledState);\n        };\n      };\n    };\n    var isToc = function (editor) {\n      return function (elm) {\n        return elm && editor.dom.is(elm, '.' + getTocClass(editor)) && editor.getBody().contains(elm);\n      };\n    };\n    var register = function (editor) {\n      var insertTocAction = function () {\n        return editor.execCommand('mceInsertToc');\n      };\n      editor.ui.registry.addButton('toc', {\n        icon: 'toc',\n        tooltip: 'Table of contents',\n        onAction: insertTocAction,\n        onSetup: toggleState(editor)\n      });\n      editor.ui.registry.addButton('tocupdate', {\n        icon: 'reload',\n        tooltip: 'Update',\n        onAction: function () {\n          return editor.execCommand('mceUpdateToc');\n        }\n      });\n      editor.ui.registry.addMenuItem('toc', {\n        icon: 'toc',\n        text: 'Table of contents',\n        onAction: insertTocAction,\n        onSetup: toggleState(editor)\n      });\n      editor.ui.registry.addContextToolbar('toc', {\n        items: 'tocupdate',\n        predicate: isToc(editor),\n        scope: 'node',\n        position: 'node'\n      });\n    };\n\n    function Plugin () {\n      global$3.add('toc', function (editor) {\n        register$1(editor);\n        register(editor);\n        setup(editor);\n      });\n    }\n\n    Plugin();\n\n}());\n"],"names":["prefix","counter","global$3","tinymce","util","Tools","resolve","global$2","global$1","global","getTocClass","editor","getParam","getTocHeader","tagName","test","tocId","guid","Date","getTime","toString","readHeaders","tocClass","headerTag","selector","depth","i","push","join","generateSelector","parseInt","getTocDepth","headers","$","length","filter","el","dom","hasClass","parentNode","map","h","id","level","nodeName","replace","title","text","element","generateTocContentHtml","tag","closeTag","html","prevLevel","minLevel","getMinLevel","translate","DOM","encode","nextLevel","ii","insertToc","$tocElm","nodes","getParents","isEmptyOrOffscreen","updateToc","insertContent","generateTocHtml","undoManager","transact","register$1","addCommand","setup","on","e","node","removeAttr","find","attr","children","toggleState","api","toggleDisabledState","setDisabled","mode","isReadOnly","hasHeaders","isToc","elm","is","getBody","contains","register","insertTocAction","execCommand","ui","registry","addButton","icon","tooltip","onAction","onSetup","addMenuItem","addContextToolbar","items","predicate","scope","position","add"],"sourceRoot":""}