(self.webpackChunk=self.webpackChunk||[]).push([[3827],{98791:()=>{window.setupBadgePrinting=function(e){const t=$("#template"),n=$("#page_layout"),a=$("#dashed_border"),i=$("#page_size"),s=$("#page_orientation"),r=$(".margin-editor"),o=$(".info");function l(e,t,n){({A0:"A2",A1:"A3",A2:"A4",A3:"A5",A4:"A6",A5:"A7",A6:"A8"})[t]===e.format&&n===e.orientation?$("#page_layout option[value='foldable']").prop("disabled",!1):($("#page_layout option[value='foldable']").prop("disabled",!0),"foldable"===$("#page_layout :selected").val()&&$("#page_layout :selected").next().prop("selected",!0))}t.on("change",(function(){const t=$(this),a=e[parseInt(t.val(),10)];n.closest(".form-group").toggle(!!a.backside_tpl_id),n.val("front_only"),l(a,i.val(),s.val())})).change(),n.on("change",(function(){r.add(o).toggle("foldable"!==$(this).val()),a.closest(".form-group").toggle("foldable"!==$(this).val())})).change(),i.add(s).on("change",(function(){l(e[parseInt(t.val(),10)],i.val(),s.val()),n.change()})).change()}},27411:(e,t,n)=>{"use strict";var a=n(20011),i=n(90567),s=n.n(i),r=n(32735),o=n(12788),l=(n(17388),n(70967),n(98791),n(60216)),c=n.n(l),d=n(19306),u=n(63025),m=n(13213),p=n(67986),v=n(73537),g=n(41612),y=n(25899),h=n(95524),f=n(32695),b=n(13613),_=n(47169),E=n(33344),D=n(59090);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,_.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const C=u.ZP.bind(null,{endpoint:"persons.api_email_event_persons_metadata",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"persons",isDynamic:!1},{data:"/",isDynamic:!1},{data:"email",isDynamic:!1},{data:"/",isDynamic:!1},{data:"metadata",isDynamic:!1}]}]},"/"),R=u.ZP.bind(null,{endpoint:"persons.api_email_event_persons_send",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"persons",isDynamic:!1},{data:"/",isDynamic:!1},{data:"email",isDynamic:!1},{data:"/",isDynamic:!1},{data:"send",isDynamic:!1}]}]},"/"),j=u.ZP.bind(null,{endpoint:"persons.email_event_persons_preview",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"persons",isDynamic:!1},{data:"/",isDynamic:!1},{data:"email",isDynamic:!1},{data:"/",isDynamic:!1},{data:"preview",isDynamic:!1}]}]},"/");function I(e){let{eventId:t,roleIds:n,persons:a,onClose:i,onSubmitSucceeded:s,noAccount:o,notInvitedOnly:l,successTimeout:c}=e;const[d,u]=(0,r.useState)(0),m={role_id:n,persons:a,no_account:o,not_invited_only:l},{data:p,loading:y}=(0,h.K3)({url:C({event_id:t}),method:"POST",data:m}),{senders:b=[],recipients:_=[],subject:S,body:I,placeholders:w=[]}=p||{};return y?r.createElement(v.Z,{active:!0,page:!0,inverted:!0},r.createElement(g.Z,null)):r.createElement(f.d,{onSubmit:async e=>{const n=N(N({},e),m);let a;n.body=n.body.getData?n.body.getData():n.body;try{a=await D.l2.post(R({event_id:t}),n)}catch(e){return(0,E.qf)(e)}u(a.data.count),s(a.data.count),setTimeout((()=>i()),c)},onClose:i,onSubmitSucceeded:s,senders:b,recipients:_,previewURL:j({event_id:t}),previewContext:{noAccount:o},placeholders:w,initialFormValues:{subject:S,body:I},sentEmailsCount:d})}I.propTypes={eventId:c().number.isRequired,roleIds:c().arrayOf(c().number),persons:c().arrayOf(c().string),onClose:c().func.isRequired,onSubmitSucceeded:c().func,noAccount:c().bool,notInvitedOnly:c().bool,successTimeout:c().number},I.defaultProps={roleIds:[],persons:[],onSubmitSucceeded:void 0,noAccount:!1,notInvitedOnly:!1,successTimeout:5e3};const w=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Array.from(document.querySelectorAll(e)).filter((e=>e.offsetWidth>0||e.offsetHeight>0)).map((e=>t?+e.value:e.value))},O=["eventId","roleId","persons","personSelector","triggerSelector","noAccount","notInvitedOnly","onSubmitSucceeded","successTimeout"];function k(e){let{eventId:t,roleId:n,persons:i,personSelector:s,triggerSelector:o,noAccount:l,notInvitedOnly:c,onSubmitSucceeded:u,successTimeout:m}=e,v=(0,b.Z)(e,O);const[g,y]=(0,r.useState)(!1);return i=s?w(s,!1):i,(0,r.useEffect)((()=>{if(!o)return;const e=()=>y(!0),t=document.querySelector(o);return t.addEventListener("click",e),()=>t.removeEventListener("click",e)}),[o]),r.createElement(r.Fragment,null,!o&&r.createElement(p.Z,(0,a.Z)({onClick:()=>y(!0),disabled:!(n||i.length)},v),r.createElement(d.vN,null,"Send emails")),g&&r.createElement(I,{eventId:t,roleIds:n&&[n],persons:i,noAccount:l,notInvitedOnly:c,onClose:()=>y(!1),onSubmitSucceeded:u,successTimeout:m}))}k.propTypes={eventId:c().number.isRequired,roleId:c().number,persons:c().arrayOf(c().string),personSelector:c().string,triggerSelector:c().string,noAccount:c().bool,notInvitedOnly:c().bool,onSubmitSucceeded:c().func,successTimeout:c().number},k.defaultProps={roleId:void 0,persons:[],personSelector:void 0,triggerSelector:void 0,noAccount:!1,notInvitedOnly:!1,onSubmitSucceeded:void 0,successTimeout:void 0};var q=n(98978),Z=n.n(q),P=n(27286),T=n(41187),A=n(59965),x=n(37314);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){(0,_.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const M=e=>Z()(e,"identifier");function F(e,t){return"CHANGE_SORT"===t.type?e.column!==t.column?{column:t.column,sortedPersons:M(e.sortedPersons).sort(((e,n)=>e[t.column].localeCompare(n[t.column]))),direction:"ascending"}:"ascending"===e.direction?{column:e.column,sortedPersons:e.sortedPersons.slice().reverse(),direction:"descending"}:{column:null,sortedPersons:M(e.sortedPersons),direction:null}:e}const H=e=>{let{primaryAuthor:t,secondaryAuthor:n}=e;return[t&&d.vN.string("Primary"),n&&d.vN.string("Co-author")].filter((e=>e)).join(", ")||"-"};function z(e){let{persons:t,selectedPersons:n,onChangeSelection:a,isSelectable:i,isVisible:s,extraRoles:o}=e;const[l,c]=(0,r.useReducer)(F,{column:null,sortedPersons:M(t).map((e=>U(U({},e),{},{authorType:H(e),selectable:i(e)}))),direction:null}),{column:u,sortedPersons:m,direction:p}=l,v=m.filter((e=>s(e))),g=v.filter((e=>e.selectable)),y=n.filter((e=>s(t.find((t=>t.identifier===e))))).length,h=[...o,{icon:"mic",isActive:e=>e.speaker,titleActive:d.vN.string("This person is a speaker"),titleInactive:d.vN.string("This person is not a speaker")}];return r.createElement(P.Z,{sortable:!0,selectable:!0,singleLine:!0},r.createElement(P.Z.Header,null,r.createElement(P.Z.Row,null,r.createElement(P.Z.HeaderCell,{disabled:!0,colSpan:"2"},r.createElement(T.Z,{indeterminate:y>0&&y<g.length,checked:y>0&&y===g.length,onChange:(e,t)=>{return n=t.checked,void a(n?g.map((e=>e.identifier)):[]);var n},disabled:!g.length})),r.createElement(d.vN,{as:P.Z.HeaderCell,sorted:"fullName"===u?p:null,onClick:()=>c({type:"CHANGE_SORT",column:"fullName"})},"Name"),r.createElement(d.vN,{as:P.Z.HeaderCell,sorted:"email"===u?p:null,onClick:()=>c({type:"CHANGE_SORT",column:"email"})},"Email"),r.createElement(d.vN,{as:P.Z.HeaderCell,sorted:"affiliation"===u?p:null,onClick:()=>c({type:"CHANGE_SORT",column:"affiliation"})},"Affiliation"),r.createElement(d.vN,{as:P.Z.HeaderCell,sorted:"authorType"===u?p:null,onClick:()=>c({type:"CHANGE_SORT",column:"authorType"})},"Author type"),r.createElement(d.vN,{as:P.Z.HeaderCell,disabled:!0},"Roles"))),r.createElement(P.Z.Body,null,v.map((e=>r.createElement(P.Z.Row,{key:e.identifier,style:e.selectable?{}:{opacity:"50%"},onClick:()=>(e=>{let{identifier:t,selectable:i}=e;i&&(n.includes(t)?a(n.filter((e=>e!==t))):a([...n,t]))})(e)},r.createElement(P.Z.Cell,{collapsing:!0},r.createElement(T.Z,{disabled:!e.selectable,checked:n.includes(e.identifier)})),r.createElement(P.Z.Cell,{collapsing:!0},r.createElement(A.Z,{content:e.registered?d.vN.string("This person is registered for the event"):d.vN.string("This person is not yet registered"),position:"bottom center",inverted:!0,trigger:r.createElement("i",{className:"icon-ticket "+(e.registered?"":"inactive")})})),r.createElement(P.Z.Cell,null,e.fullName),r.createElement(P.Z.Cell,null,e.email),r.createElement(P.Z.Cell,null,e.affiliation),r.createElement(P.Z.Cell,null,e.authorType),r.createElement(P.Z.Cell,{collapsing:!0},h.map((t=>{let{icon:n,isActive:a,titleActive:i,titleInactive:s}=t;return r.createElement(A.Z,{key:n,content:a(e)?i:s,position:"bottom center",inverted:!0,trigger:r.createElement("i",{key:n,className:`icon-${n} ${a(e)?"":"inactive"}`})})})))))),!v.length&&r.createElement(P.Z.Row,{warning:!0},r.createElement(P.Z.Cell,{colSpan:"7"},r.createElement(x.Z,{name:"attention"}),r.createElement(d.vN,null,"No persons were found matching the selected criteria.")))))}z.propTypes={persons:c().arrayOf(c().shape({identifier:c().string.isRequired,fullName:c().string.isRequired,email:c().string.isRequired,affiliation:c().string.isRequired,speaker:c().bool.isRequired,primaryAuthor:c().bool.isRequired,secondaryAuthor:c().bool.isRequired,registered:c().bool.isRequired})).isRequired,selectedPersons:c().arrayOf(c().string).isRequired,onChangeSelection:c().func.isRequired,isSelectable:c().func,isVisible:c().func,extraRoles:c().arrayOf(c().shape({icon:c().string.isRequired,isActive:c().func.isRequired,titleActive:c().string.isRequired,titleInactive:c().string.isRequired}))},z.defaultProps={isSelectable:()=>!0,isVisible:()=>!0,extraRoles:[]};const B=u.ZP.bind(null,{endpoint:"abstracts.person_list",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"abstracts",isDynamic:!1},{data:"/",isDynamic:!1},{data:"person-list",isDynamic:!1}]}]},"/"),V=u.ZP.bind(null,{endpoint:"contributions.person_list",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"person-list",isDynamic:!1}]}]},"/"),K=u.ZP.bind(null,{endpoint:"sessions.person_list",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"sessions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"person-list",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),Q={abstracts:{idType:"abstract_id",personListURL:B},contributions:{idType:"contribution_id",personListURL:V,emptyListMessage:d.vN.string("There are no persons associated with the selected contributions")},sessions:{idType:"session_id",personListURL:K,emptyListMessage:d.vN.string("There are no persons associated with contributions in the selected sessions")}},G={submitter:{text:d.vN.string("Submitters"),isMatch:e=>e.submitter,contexts:["abstracts"]},speaker:{text:d.vN.string("Speakers"),isMatch:e=>e.speaker},primaryAuthor:{text:d.vN.string("Primary authors"),isMatch:e=>e.primaryAuthor},secondaryAuthor:{text:d.vN.string("Co-authors"),isMatch:e=>e.secondaryAuthor},notRegistered:{text:d.vN.string("Not registered"),isMatch:e=>!e.registered}};function W(e){let{eventId:t,sourceIds:n,objectContext:a,onClose:i}=e;const[s,o]=(0,r.useState)([]),[l,c]=(0,r.useState)(void 0),[u,b]=(0,r.useState)([]),_=new FormData;n.forEach((e=>_.append(Q[a].idType,e)));const{data:E,loading:D}=(0,h.K3)({url:Q[a].personListURL({event_id:t}),method:"POST",data:_,headers:{"content-type":"multipart/form-data"}},{camelize:!0}),S="abstracts"===a?[{icon:"user-check icon",isActive:e=>e.submitter,titleActive:d.vN.string("This person submitted an abstract"),titleInactive:d.vN.string("This person hasn't submitted any abstracts")}]:void 0,N=e=>!u.length||u.some((t=>G[t].isMatch(e))),C=Object.entries(G).filter((e=>{let[,t]=e;return!t.contexts||t.contexts.includes(a)})).map((e=>{let[t,n]=e;return{key:t,content:n.text,onClick:()=>(e=>{b(u.includes(e)?u.filter((t=>t!==e)):[...u,e])})(t),primary:u.includes(t)}}));return r.createElement(m.Z,{open:!0,onClose:()=>i(),size:"large"},r.createElement(m.Z.Header,{content:d.vN.string("Authors list")}),r.createElement(m.Z.Content,null,l&&r.createElement(f.Q,{count:l}),r.createElement("div",null,r.createElement(d.vN,{as:"div",style:{display:"inline-block",fontWeight:"bold",padding:"0.5em"}},"Filter by"),r.createElement(p.Z.Group,{buttons:C,compact:!0})),D||!E?r.createElement(v.Z,{active:!0},r.createElement(g.Z,null)):Object.keys(E.eventPersons).length?r.createElement(z,{persons:Object.values(E.eventPersons),selectedPersons:s,onChangeSelection:e=>o(e),isSelectable:e=>!!e.email,isVisible:N,extraRoles:S}):r.createElement(y.Z,{error:!0},Q[a].emptyListMessage)),r.createElement(m.Z.Actions,null,r.createElement(k,{eventId:t,persons:s.filter((e=>N(E.eventPersons[e]))),onSubmitSucceeded:e=>c(e),successTimeout:0,primary:!0}),r.createElement(d.vN,{as:p.Z,onClick:()=>i()},"Close")))}function Y(e){let{eventId:t,objectContext:n,paramsSelector:a}=e;const[i,s]=(0,r.useState)(!1),o=w(a);return r.createElement(r.Fragment,null,r.createElement("button",{type:"button",className:"i-button icon-users js-requires-selected-row disabled",onClick:e=>{e.target.classList.contains("disabled")||s(!0)}},r.createElement(d.vN,null,"Authors list")),i&&r.createElement(W,{eventId:t,sourceIds:o,objectContext:n,onClose:()=>s(!1)}))}function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){(0,_.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(e){let{context:t,metadataURL:n,previewURL:a,sendURL:i,onClose:s}=e;const[o,l]=(0,r.useState)(0),{data:c,loading:u}=(0,h.K3)({url:n,method:"POST",data:t}),{senders:m=[],subject:p,body:y,placeholders:b=[]}=c||{},_=[{name:"speaker",title:d.vN.string("Speaker")},{name:"author",title:d.vN.string("Author")},{name:"coauthor",title:d.vN.string("Co-author")},{name:"submitter",title:d.vN.string("Submitter")}];return u?r.createElement(v.Z,{active:!0,page:!0,inverted:!0},r.createElement(g.Z,null)):r.createElement(f.d,{onSubmit:async e=>{const n=J(J({},e),t);let a;n.body=n.body.getData?n.body.getData():n.body;try{a=await D.l2.post(i,n)}catch(e){return(0,E.qf)(e)}l(a.data.count),setTimeout((()=>s()),5e3)},onClose:s,senders:m,previewURL:a,placeholders:b,initialFormValues:{subject:p,body:y,recipient_roles:[]},sentEmailsCount:o,recipientsField:r.createElement(E.yZ,{name:"recipient_roles",label:d.vN.string("Send emails to these roles"),multiple:!0,selection:!0,options:_.map((e=>{let{name:t,title:n}=e;return{value:t,text:n,key:t}})),required:!0})})}function te(e){let{objectContext:t,idSelector:n,metadataURL:a,previewURL:i,sendURL:s}=e;const[o,l]=(0,r.useState)(!1),c=w(n),u={abstracts:"abstract_id",contributions:"contribution_id"}[t];return r.createElement(r.Fragment,null,r.createElement("button",{type:"button",className:"i-button icon-mail js-requires-selected-row disabled",onClick:e=>{e.target.classList.contains("disabled")||l(!0)}},r.createElement(d.vN,null,"Email")),o&&r.createElement(ee,{context:{[u]:c},metadataURL:a,previewURL:i,sendURL:s,onClose:()=>l(!1)}))}W.propTypes={eventId:c().number.isRequired,sourceIds:c().arrayOf(c().number).isRequired,objectContext:c().oneOf(Object.keys(Q)).isRequired,onClose:c().func.isRequired},Y.propTypes={eventId:c().number.isRequired,objectContext:c().oneOf(Object.keys(Q)).isRequired,paramsSelector:c().string.isRequired},ee.propTypes={context:c().object.isRequired,metadataURL:c().string.isRequired,previewURL:c().string.isRequired,sendURL:c().string.isRequired,onClose:c().func.isRequired},te.propTypes={objectContext:c().oneOf(["abstracts","contributions"]).isRequired,idSelector:c().string.isRequired,metadataURL:c().string.isRequired,previewURL:c().string.isRequired,sendURL:c().string.isRequired};var ne=n(28995),ae=n(17816),ie=n(72963),se=n(89793),re=n.n(se),oe=n(53806),le=n.n(oe),ce=n(74763),de=n(68301),ue=n(75723),me=n(8892),pe=n(54733),ve=n(5163);const ge="events-management-client-js-___SeriesManagement-module__load-more___6T2U4",ye=u.ZP.bind(null,{endpoint:"categories.event_search",rules:[{args:["category_id"],converters:{category_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category",isDynamic:!1},{data:"/",isDynamic:!1},{data:"category_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"events",isDynamic:!1},{data:"/",isDynamic:!1},{data:"search-for-series",isDynamic:!1}]}]},"/"),he=u.ZP.bind(null,{endpoint:"event_series.event_series",rules:[{args:["series_id"],converters:{series_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event-series",isDynamic:!1},{data:"/",isDynamic:!1},{data:"series_id",isDynamic:!0}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event-series",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),fe=u.ZP.bind(null,{endpoint:"events.single_event_api",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"info-for-series",isDynamic:!1}]}]},"/"),be=(0,ve.c)(250),_e=(0,ve.c)(250);function Ee(e){let{eventId:t,categoryId:n,seriesId:a,timezone:i}=e;const s=null!==a,[o,l]=(0,r.useState)(!1),{loading:c,reFetch:u,data:m}=(0,h.K3)(s?he({series_id:a}):fe({event_id:t}),{manual:!0}),p=async()=>{await u(),l(!0)},y=m?s?m:{id:null,events:[m],show_sequence_in_title:!1,show_links:!1,event_title_pattern:""}:null;return r.createElement(r.Fragment,null,s?r.createElement(me.IButton,{borderless:!0,icon:"stack",title:d.vN.string("Manage event series"),onClick:p},r.createElement(d.vN,null,"Manage series")):r.createElement(me.IButton,{borderless:!0,icon:"stack",title:d.vN.string("Create event series"),onClick:p},r.createElement(d.vN,null,"Create series")),r.createElement(v.Z,{active:c,page:!0,inverted:!0},r.createElement(g.Z,null)),o&&r.createElement(De,{currentEventId:t,categoryId:n,timezone:i,series:y,onClose:()=>{l(!1)}}))}function De(e){let{currentEventId:t,categoryId:n,series:a,timezone:i,onClose:s}=e;const[o,l]=(0,r.useState)(!1),c=null!==a.id,u=e=>le()(e).tz(i);return r.createElement(r.Fragment,null,r.createElement(pe.Yp,{id:"event-series",header:c?d.vN.string("Manage series"):d.vN.string("Create series"),size:"standard",alignTop:!0,onSubmit:async(e,t)=>{const n=c?(0,pe.k4)(e,t):(0,pe.hS)(e,t);n.events&&(n.event_ids=n.events.map((e=>e.id)),delete n.events);try{c?await D.l2.patch(he({series_id:a.id}),n):await D.l2.post(he(),n)}catch(e){return(0,E.qf)(e,{event_ids:"events"})}location.reload(),await new Promise((()=>{}))},onClose:s,initialValues:a,disabledUntilChange:c,extraActions:e=>c&&r.createElement(p.Z,{style:{marginRight:"auto"},onClick:()=>l(!0),disabled:e.submitting,negative:!0},r.createElement(d.vN,null,"Delete series")),submitLabel:c?d.vN.string("Update series"):d.vN.string("Create series")},(()=>r.createElement(r.Fragment,null,r.createElement(E.HS,{name:"events",isEqual:(e,t)=>re()((e||[]).map((e=>e.id)),(t||[]).map((e=>e.id))),validate:e=>{if(!e.length)return d.vN.string("A series needs to contain at least one event.")},component:Se,localMoment:u,categoryId:n,currentEventId:t,existingSeriesId:a.id,divider:r.createElement(ce.Z,{horizontal:!0},c?r.createElement(d.vN,null,"Events in series"):r.createElement(d.vN,null,"Events to add"))}),r.createElement(ce.Z,{horizontal:!0},r.createElement(d.vN,null,"Series options")),r.createElement(E.fw,{name:"show_sequence_in_title",label:d.vN.string("Show the sequence number in the event titles (lectures only)")}),r.createElement(E.fw,{name:"show_links",label:d.vN.string("Show links to the other events of the series on the main event page")}),r.createElement(E._t,{name:"event_title_pattern",label:d.vN.string("Event title pattern"),description:r.createElement(d.vN,null,"Title pattern for cloned events. Must contain the"," ",r.createElement(d.dO,{name:"placeholder",wrapper:r.createElement("code",null),value:"{n}"})," placeholder which will indicate the new event's position in the series."),validate:e=>{if(e&&!e.includes("{n}"))return d.vN.string("Title pattern must contain the {placeholder} placeholder",{placeholder:"{n}"})}})))),r.createElement(me.RequestConfirmDelete,{open:o,onClose:()=>l(!1),requestFunc:async()=>{try{await D.l2.delete(he({series_id:a.id}))}catch(e){return(0,D.zZ)(e),!0}location.reload()},persistent:!0},r.createElement(d.vN,null,"Do you really want to delete this series? The associated events will not be deleted.")))}function Se(e){let{value:t,onChange:n,onFocus:a,onBlur:i,divider:s,localMoment:o,categoryId:l,currentEventId:c,existingSeriesId:u}=e;const[m,v]=(0,r.useState)(void 0),[g,y]=(0,r.useState)([]),[h,f]=(0,r.useState)(!1),[b,_]=(0,r.useState)(!1),[E,S]=(0,r.useState)(null),N=null!==u,C=async e=>{let t;try{t=await _e((()=>D.l2.get(fe({event_id:+e}))))}catch(e){return void(0,D.zZ)(e)}if(null===t.data)S(d.vN.string("No event found with this ID."));else if(t.data.can_access){if(t.data.category_chain)return y([t.data]),S(null),void _(!1);S(d.vN.string("This event is unlisted."))}else S(d.vN.string("You don't have rights to access this event."));_(!1),y([])},R=async function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{t=await be((()=>D.l2.get(ye({category_id:l,q:e,offset:n}))))}catch(e){return void(0,D.zZ)(e)}y(a?[...g,...t.data.events]:t.data.events),f(t.data.has_more),S(null),_(!1)},j=new Set(t.map((e=>e.id)));let I=g.map((e=>({key:e.id,value:e.id,text:e.title,disabled:!e.can_manage||!e.category_chain||e.series_id!==u&&null!==e.series_id||j.has(e.id),content:r.createElement("div",{className:"events-management-client-js-___SeriesManagement-module__list-flex___DE65m"},r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__date-span___8yRl2"},o(e.start_dt).format("ll")),r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__event-title___961dm"},e.title,r.createElement("br",null),r.createElement(me.TooltipIfTruncated,null,r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__category-chain___SNXOv"},e.category_chain?e.category_chain.join(" » "):r.createElement(d.vN,null,"Unlisted"))),!e.can_manage&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement("br",null),r.createElement(d.vN,null,"You do not have editing rights for this event.")),!e.category_chain&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement("br",null),r.createElement(d.vN,null,"This event is unlisted.")),e.series_id!==u&&null!==e.series_id&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement("br",null),r.createElement(d.vN,null,"This event is already part of a different series.")),j.has(e.id)&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__positive-note___TNVKv"},r.createElement("br",null),r.createElement(d.vN,null,"This event is already part of this series."))))})));const w=()=>{_(!0),R(m.trim(),g.length,!0)};return I.length>0&&h&&(I=[...I,{key:"_",value:"_",className:ge,content:r.createElement("div",{onClick:e=>{e.stopPropagation()}},r.createElement(p.Z,{primary:!0,compact:!0,size:"small",type:"button",loading:b,onClick:w},r.createElement(d.vN,null,"Load more")))}]),r.createElement(r.Fragment,null,r.createElement(de.Z,{fluid:!0,selection:!0,search:e=>e,icon:"search",closeOnChange:!1,selectOnBlur:!1,selectOnNavigation:!1,placeholder:d.vN.string("Search for an event title or paste an event URL or event ID (#123)"),options:I,value:null,loading:b,onSearchChange:async(e,t)=>{let{searchQuery:n}=t;if(f(!1),v(n),n=n.trim(),S(null),!n)return _(!1),void y([]);const a=new RegExp(`^${location.origin.replace("/","\\/")}\\/event\\/([0-9]+)`),i=n.match(a);i?(_(!0),C(i[1])):/^#([0-9])+$/.test(n)?(_(!0),C(n.substr(1))):"#"!==n&&(_(!0),R(n))},searchQuery:m,onChange:(e,a)=>{let{value:i}=a;if("_"===i)return;const s=g.find((e=>e.id===i)),r=[...t,s].sort(((e,t)=>le()(e.start_dt)-le()(t.start_dt)));n(r)},onFocus:a,onBlur:i,noResultsMessage:b?d.vN.string("Searching..."):null!==E?E:m?d.vN.string("No results found."):d.vN.string("Enter search term")}),s,r.createElement(ue.Z,{divided:!0,relaxed:!0,className:"events-management-client-js-___SeriesManagement-module__evt-list___PkKqH"},t.map((e=>r.createElement(ue.Z.Item,{key:e.id,className:"events-management-client-js-___SeriesManagement-module__evt-item___5iu8a"},r.createElement(ue.Z.Content,null,r.createElement("div",{className:"events-management-client-js-___SeriesManagement-module__list-flex___DE65m"},r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__date-span___8yRl2"},o(e.start_dt).format("ll"),r.createElement("br",null),c===e.id&&r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__positive-note___TNVKv"},"(",r.createElement(d.vN,null,"this event"),")")),r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__event-title___961dm"},e.title,r.createElement("br",null),r.createElement(me.TooltipIfTruncated,null,r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__detail___mXZyy"},e.category_chain?e.category_chain.join(" » "):r.createElement("span",{className:"events-management-client-js-___SeriesManagement-module__warning-reason___ag6NQ"},r.createElement(d.vN,null,"Unlisted"))))),(c!==e.id||N)&&r.createElement(A.Z,{trigger:r.createElement(x.Z,{className:"events-management-client-js-___SeriesManagement-module__delete-button___BZmEH",name:"close",onClick:()=>{a(),i(),n(t.filter((t=>t.id!==e.id)))},link:!0}),content:d.vN.string("Remove from event series"),position:"bottom center"}))))))))}Ee.propTypes={eventId:c().number.isRequired,categoryId:c().number.isRequired,timezone:c().string.isRequired,seriesId:c().number},Ee.defaultProps={seriesId:null},De.propTypes={currentEventId:c().number.isRequired,categoryId:c().number.isRequired,series:c().shape({id:c().number,events:c().arrayOf(c().object).isRequired,show_sequence_in_title:c().bool.isRequired,show_links:c().bool.isRequired,event_title_pattern:c().string.isRequired}).isRequired,timezone:c().string.isRequired,onClose:c().func.isRequired},Se.propTypes={value:c().arrayOf(c().object).isRequired,onChange:c().func.isRequired,divider:c().node.isRequired,localMoment:c().func.isRequired,categoryId:c().number.isRequired,currentEventId:c().number.isRequired,existingSeriesId:c().number,onFocus:c().func.isRequired,onBlur:c().func.isRequired},Se.defaultProps={existingSeriesId:null},function(e){function t(){$("#person-filters ul > li").removeClass("enabled");const e=$(".js-event-person-list tr[data-person-roles]"),t=$(".js-event-person-list [data-filter]:checked").map((function(){const e=$(this);return e.closest("li").addClass("enabled"),e.data("filter")})).get(),n=e.filter(((e,n)=>!t.length||t.find((e=>$(n).data("person-roles")[e]))));e.addClass("hidden"),n.removeClass("hidden"),$(".js-event-person-list").trigger("indico:syncEnableIfChecked")}function n(){$(".js-reset-role-filter").toggleClass("disabled",0===$("#person-filters [data-filter]:checked").length)}function i(){$(".js-show-regforms").qtip({content:{text(){return $(this).data("title")}},hide:{delay:100,fixed:!0}})}e.setupEmailButton=function(e,t){const n=document.querySelector(e),{eventId:i,roleId:s,personSelector:l}=n.dataset,c={};void 0!==n.dataset.noAccount&&(c.noAccount=!0),void 0!==n.dataset.notInvitedOnly&&(c.notInvitedOnly=!0),o.render(r.createElement(k,(0,a.Z)({eventId:+i,roleId:s&&+s,personSelector:l,triggerSelector:t},c)),n)},e.setupEmailContribAbstractRoles=function(e){const t=document.querySelector(e),{objectContext:n,idSelector:a,metadataUrl:i,previewUrl:s,sendUrl:l}=t.dataset;o.render(r.createElement(te,{objectContext:n,idSelector:a,metadataURL:i,previewURL:s,sendURL:l}),t)},e.setupAuthorsListButton=function(e){const t=document.querySelector(e),{eventId:n,objectContext:a,paramsSelector:i}=t.dataset;o.render(r.createElement(Y,{eventId:+n,objectContext:a,paramsSelector:i}),t)},e.setupEventManagementActionMenu=function(){const e=document.querySelector("#event-action-move-container");e&&o.render(r.createElement(ie.BN,{eventId:+e.dataset.eventId,currentCategoryId:+e.dataset.categoryId,hasPendingMoveRequest:void 0!==e.dataset.pendingRequest}),e);const t=document.querySelector("#event-action-manage-series-container");if(t){const e=void 0!==t.dataset.seriesId?+t.dataset.seriesId:null;o.render(r.createElement(Ee,{eventId:+t.dataset.eventId,categoryId:+t.dataset.categoryId,timezone:t.dataset.timezone,seriesId:e}),t)}const n=document.querySelector("#event-action-publish-container");n&&o.render(r.createElement(ie.CT,{eventId:+n.dataset.eventId,hasPendingPublishRequest:void 0!==n.dataset.pendingRequest}),n),$("#event-action-menu-clones-target").qbubble({content:{text:$("#event-action-menu-clones")}}),$("#event-action-menu-actions-target").qbubble({content:{text:$("#event-action-menu-actions")},style:{classes:"qtip-allow-overflow"}});$(["#event-action-menu-actions button:not(.js-dropdown)","#event-action-menu-actions a:not(.disabled)"].join(", ")).on("click",(function(){$("#event-action-menu-actions-target").qbubble("hide")}))},e.setupEventPersonsList=function(e){e=$.extend({hasNoAccountFilter:!1,hasNoRegistrationFilter:!1,hasNoBuiltinRolesFilter:!1},e);const a=setupSearchBox({itemHandle:"tr",listItems:"#event-participants-list tbody tr:not(.hidden)",term:"#search-input",state:"#filtering-state",placeholder:"#filter-placeholder"});enableIfChecked(".js-event-person-list",".select-row:visible",".js-event-person-list .js-requires-selected-row"),$(".js-event-person-list").closest(".ui-dialog").length&&$(".js-event-person-list [data-toggle=dropdown]").closest(".toolbar").dropdown(),$(".js-event-person-list [data-filter]").on("click",t),$(".js-event-person-list td").on("mouseenter",(function(){const e=$(this);this.offsetWidth<this.scrollWidth&&!e.attr("title")&&e.attr("title",e.text())})),$(".js-event-person-list .tablesorter").tablesorter({cssAsc:"header-sort-asc",cssDesc:"header-sort-desc",headerTemplate:"",sortList:[[1,0]]});const r=$(".js-event-person-list .roles-column > span");r.qbubble({show:{event:"mouseover"},hide:{fixed:!0,delay:100,event:"mouseleave"},position:{my:"left center",at:"right center"},content:{text(){const e=$(this),t=$("<div>"),n=$("<strong>",{text:$(this).data("role-name")});if(t.append(n),e.is(".js-count-label")){const n=$("<ul>",{class:"qbubble-item-list"}),a=s()(e.data("items")).sort((function(e,t){return(0,ae.U)(e.title.toLowerCase(),t.title.toLowerCase())}));$.each(a,(function(){const e=$("<li>");this.url?e.append($("<a>",{text:this.title,href:this.url})):e.text(this.title),n.append(e)})),t.append(n)}return t}}}),r.filter(".custom").each((function(){const e=$(this);e.css("background-color",$.Color(e.css("color")).alpha(.1))})),e.hasNoAccountFilter&&($(".js-event-person-list [data-filter]:not(#filter-no-account)").on("change",(function(){$("#filter-no-account").prop("checked",!1),t(),a()})),$("#filter-no-account").on("change",(function(){this.checked&&$(".js-event-person-list [data-filter]:checked:not(#filter-no-account)").prop("checked",!1),t(),a()}))),e.hasNoRegistrationFilter&&($(".js-event-person-list [data-filter]:not(#filter-no-registration)").on("change",(function(){$("#filter-no-registration").prop("checked",!1),t(),a()})),$("#filter-no-registration").on("change",(function(){this.checked&&$(".js-event-person-list [data-filter]:checked:not(#filter-no-registration)").prop("checked",!1),t(),a()}))),e.hasNoBuiltinRolesFilter&&($(".js-event-person-list [data-filter]:not(#filter-no-builtin-roles)").on("change",(function(){$("#filter-no-builtin-roles").prop("checked",!1),t(),a()})),$("#filter-no-builtin-roles").on("change",(function(){this.checked&&$(".js-event-person-list [data-filter]:checked:not(#filter-no-builtin-roles)").prop("checked",!1),t(),a()}))),i();const o=$("#person-filters");o.find("li .colored-square").each((function(){const e=$(this);e.closest("li").css("background-color",$.Color(e.css("color")).alpha(.1))})),o.find(".js-reset-role-filter").on("click",(function(){$(".js-event-person-list [data-filter]").each((function(){const e=$(this);e.prop("checked",!1),e.parent().toggleClass("enabled",!1)})),t(),a(),n()})),o.find("li label").on("click",(function(e){e.preventDefault()})),o.find("li").on("click",(function(){const e=$(this).find("[data-filter]");e.prop("checked",!e.prop("checked")).trigger("change"),n()})),$("#event-participants-list").on("indico:htmlUpdated",i)},e.showUndoWarning=function(e,t,n){cornerMessage({message:e,progressMessage:ne.$T.gettext("Undoing previous operation..."),feedbackMessage:t,actionLabel:ne.$T.gettext("Undo"),actionCallback:n,duration:1e4,feedbackDuration:4e3,class:"warning"})},e.handleSelectedRowHighlight=function(e){const t=$("table.i-table input.select-row").on("change",(function(){$(this).closest("tr").toggleClass("selected",this.checked)}));e&&t.trigger("change")},e.showThemeSettingsForm=function(e){e=$.extend(!0,{formUrl:null,themeFieldId:null,lastFieldId:null},e),$(`#${e.themeFieldId}`).on("change",(function(){$.ajax({url:e.formUrl,data:{theme:$(this).val()},complete:IndicoUI.Dialogs.Util.progress(),error:handleAjaxError,success(t){const n=$(`#${e.lastFieldId}`);n.nextAll(":not(.form-group-footer)").remove(),t.html&&n.after(t.html),t.js&&$("body").append(t.js)}})}))}}(window)}},e=>{e.O(0,[5514,3044,8592],(()=>{return t=27411,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=module_events.management.18e61850.bundle.js.map